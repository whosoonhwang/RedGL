!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=a=t},e.toRadian=function(t){return t*i},e.equals=function(t,e){return Math.abs(t-e)<=n*Math.max(1,Math.abs(t),Math.abs(e))};var n=e.EPSILON=1e-6,a=e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i=(e.RANDOM=Math.random,Math.PI/180)},function(t,e,r){"use strict";function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=e[6],c=e[7],h=e[8],d=r[0],l=r[1],_=r[2],M=r[3],R=r[4],m=r[5],I=r[6],v=r[7],E=r[8];return t[0]=d*n+l*o+_*f,t[1]=d*a+l*u+_*c,t[2]=d*i+l*s+_*h,t[3]=M*n+R*o+m*f,t[4]=M*a+R*u+m*c,t[5]=M*i+R*s+m*h,t[6]=I*n+v*o+E*f,t[7]=I*a+v*u+E*c,t[8]=I*i+v*s+E*h,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,r,n,a,o,u,s,f){var c=new i.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=o,c[6]=u,c[7]=s,c[8]=f,c},e.set=function(t,e,r,n,a,i,o,u,s,f){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=s,t[8]=f,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],f=e[7],c=e[8],h=c*o-u*f,d=-c*i+u*s,l=f*i-o*s,_=r*h+n*d+a*l;return _?(_=1/_,t[0]=h*_,t[1]=(-c*n+a*f)*_,t[2]=(u*n-a*o)*_,t[3]=d*_,t[4]=(c*r-a*s)*_,t[5]=(-u*r+a*i)*_,t[6]=l*_,t[7]=(-f*r+n*s)*_,t[8]=(o*r-n*i)*_,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],f=e[7],c=e[8];return t[0]=o*c-u*f,t[1]=a*f-n*c,t[2]=n*u-a*o,t[3]=u*s-i*c,t[4]=r*c-a*s,t[5]=a*i-r*u,t[6]=i*f-o*s,t[7]=n*s-r*f,t[8]=r*o-n*i,t},e.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],f=t[8];return e*(f*i-o*s)+r*(-f*a+o*u)+n*(s*a-i*u)},e.multiply=n,e.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=e[6],c=e[7],h=e[8],d=r[0],l=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=s,t[6]=d*n+l*o+f,t[7]=d*a+l*u+c,t[8]=d*i+l*s+h,t},e.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=e[6],c=e[7],h=e[8],d=Math.sin(r),l=Math.cos(r);return t[0]=l*n+d*o,t[1]=l*a+d*u,t[2]=l*i+d*s,t[3]=l*o-d*n,t[4]=l*u-d*a,t[5]=l*s-d*i,t[6]=f,t[7]=c,t[8]=h,t},e.scale=function(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,u=n+n,s=a+a,f=r*o,c=n*o,h=n*u,d=a*o,l=a*u,_=a*s,M=i*o,R=i*u,m=i*s;return t[0]=1-h-_,t[3]=c-m,t[6]=d+R,t[1]=c+m,t[4]=1-f-_,t[7]=l-M,t[2]=d-R,t[5]=l+M,t[8]=1-f-h,t},e.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],f=e[7],c=e[8],h=e[9],d=e[10],l=e[11],_=e[12],M=e[13],R=e[14],m=e[15],I=r*u-n*o,v=r*s-a*o,E=r*f-i*o,x=n*s-a*u,g=n*f-i*u,A=a*f-i*s,T=c*M-h*_,b=c*R-d*_,p=c*m-l*_,w=h*R-d*M,y=h*m-l*M,U=d*m-l*R,L=I*U-v*y+E*w+x*p-g*b+A*T;return L?(L=1/L,t[0]=(u*U-s*y+f*w)*L,t[1]=(s*p-o*U-f*b)*L,t[2]=(o*y-u*p+f*T)*L,t[3]=(a*y-n*U-i*w)*L,t[4]=(r*U-a*p+i*b)*L,t[5]=(n*p-r*y-i*T)*L,t[6]=(M*A-R*g+m*x)*L,t[7]=(R*E-_*A-m*v)*L,t[8]=(_*g-M*E+m*I)*L,t):null},e.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},e.subtract=a,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],u=t[4],s=t[5],f=t[6],c=t[7],h=t[8],d=e[0],l=e[1],_=e[2],M=e[3],R=e[4],m=e[5],I=e[6],v=e[7],E=e[8];return Math.abs(r-d)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-l)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-_)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(o-M)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(u-R)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(s-m)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(f-I)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(c-v)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-E)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=n,e.sub=a},function(t,e,r){"use strict";function n(){var t=new _.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function a(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function i(t,e,r){var n=new _.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n}function o(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function u(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function s(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)}function c(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a}function h(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function d(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=n,e.clone=function(t){var e=new _.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=a,e.fromValues=i,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},e.subtract=o,e.multiply=u,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},e.distance=f,e.squaredDistance=c,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=d,e.dot=l,e.cross=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],u=r[1],s=r[2];return t[0]=a*s-i*u,t[1]=i*o-n*s,t[2]=n*u-a*o,t},e.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t},e.hermite=function(t,e,r,n,a,i){var o=i*i,u=o*(2*i-3)+1,s=o*(i-2)+i,f=o*(i-1),c=o*(3-2*i);return t[0]=e[0]*u+r[0]*s+n[0]*f+a[0]*c,t[1]=e[1]*u+r[1]*s+n[1]*f+a[1]*c,t[2]=e[2]*u+r[2]*s+n[2]*f+a[2]*c,t},e.bezier=function(t,e,r,n,a,i){var o=1-i,u=o*o,s=i*i,f=u*o,c=3*i*u,h=3*s*o,d=s*i;return t[0]=e[0]*f+r[0]*c+n[0]*h+a[0]*d,t[1]=e[1]*f+r[1]*c+n[1]*h+a[1]*d,t[2]=e[2]*f+r[2]*c+n[2]*h+a[2]*d,t},e.random=function(t,e){e=e||1;var r=2*_.RANDOM()*Math.PI,n=2*_.RANDOM()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t},e.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o,t},e.transformMat3=function(t,e,r){var n=e[0],a=e[1],i=e[2];return t[0]=n*r[0]+a*r[3]+i*r[6],t[1]=n*r[1]+a*r[4]+i*r[7],t[2]=n*r[2]+a*r[5]+i*r[8],t},e.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],u=r[1],s=r[2],f=r[3],c=f*n+u*i-s*a,h=f*a+s*n-o*i,d=f*i+o*a-u*n,l=-o*n-u*a-s*i;return t[0]=c*f+l*-o+h*-s-d*-u,t[1]=h*f+l*-u+d*-o-c*-s,t[2]=d*f+l*-s+c*-u-h*-o,t},e.rotateX=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},e.rotateY=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},e.rotateZ=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},e.angle=function(t,e){var r=i(t[0],t[1],t[2]),n=i(e[0],e[1],e[2]);d(r,r),d(n,n);var a=l(r,n);return a>1?0:a<-1?Math.PI:Math.acos(a)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],o=e[1],u=e[2];return Math.abs(r-i)<=_.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=_.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-u)<=_.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))};var _=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.sub=o,e.mul=u,e.div=s,e.dist=f,e.sqrDist=c,e.len=a,e.sqrLen=h,e.forEach=function(){var t=n();return function(e,r,n,a,i,o){var u=void 0,s=void 0;for(r||(r=3),n||(n=0),s=a?Math.min(a*r+n,e.length):e.length,u=n;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],i(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}()},function(t,e,r){"use strict";function n(){var t=new l.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function o(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function u(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function s(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+i*i)}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return r*r+n*n+a*a+i*i}function c(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.sqrt(e*e+r*r+n*n+a*a)}function h(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a}function d(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=a*o,t[3]=i*o),t}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=n,e.clone=function(t){var e=new l.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,r,n){var a=new l.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=a,e.multiply=i,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=u,e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.distance=s,e.squaredDistance=f,e.length=c,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=d,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],u=e[3];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t[3]=u+n*(r[3]-u),t},e.random=function(t,e){return e=e||1,t[0]=l.RANDOM(),t[1]=l.RANDOM(),t[2]=l.RANDOM(),t[3]=l.RANDOM(),d(t,t),u(t,t,e),t},e.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,t},e.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],u=r[1],s=r[2],f=r[3],c=f*n+u*i-s*a,h=f*a+s*n-o*i,d=f*i+o*a-u*n,l=-o*n-u*a-s*i;return t[0]=c*f+l*-o+h*-s-d*-u,t[1]=h*f+l*-u+d*-o-c*-s,t[2]=d*f+l*-s+c*-u-h*-o,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=e[0],u=e[1],s=e[2],f=e[3];return Math.abs(r-o)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-u)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-s)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-f)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))};var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.sub=a,e.mul=i,e.div=o,e.dist=s,e.sqrDist=f,e.len=c,e.sqrLen=h,e.forEach=function(){var t=n();return function(e,r,n,a,i,o){var u=void 0,s=void 0;for(r||(r=4),n||(n=0),s=a?Math.min(a*r+n,e.length):e.length,u=n;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],i(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}()},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var a=n(r(0)),i=n(r(5)),o=n(r(6)),u=n(r(1)),s=n(r(7)),f=n(r(8)),c=n(r(9)),h=n(r(2)),d=n(r(3));e.glMatrix=a,e.mat2=i,e.mat2d=o,e.mat3=u,e.mat4=s,e.quat=f,e.vec2=c,e.vec3=h,e.vec4=d},function(t,e,r){"use strict";function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=r[0],s=r[1],f=r[2],c=r[3];return t[0]=n*u+i*s,t[1]=a*u+o*s,t[2]=n*f+i*c,t[3]=a*f+o*c,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,r,n){var a=new i.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},e.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},e.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*i-a*n;return o?(o=1/o,t[0]=i*o,t[1]=-n*o,t[2]=-a*o,t[3]=r*o,t):null},e.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=n,e.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=n*-u+i*s,t[3]=a*-u+o*s,t},e.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=r[0],s=r[1];return t[0]=n*u,t[1]=a*u,t[2]=i*s,t[3]=o*s,t},e.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=a,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],u=e[0],s=e[1],f=e[2],c=e[3];return Math.abs(r-u)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=n,e.sub=a},function(t,e,r){"use strict";function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=r[0],c=r[1],h=r[2],d=r[3],l=r[4],_=r[5];return t[0]=n*f+i*c,t[1]=a*f+o*c,t[2]=n*h+i*d,t[3]=a*h+o*d,t[4]=n*l+i*_+u,t[5]=a*l+o*_+s,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){var e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,r,n,a,o){var u=new i.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=o,u},e.set=function(t,e,r,n,a,i,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t},e.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=r*i-n*a;return s?(s=1/s,t[0]=i*s,t[1]=-n*s,t[2]=-a*s,t[3]=r*s,t[4]=(a*u-i*o)*s,t[5]=(n*o-r*u)*s,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=n,e.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=Math.sin(r),c=Math.cos(r);return t[0]=n*c+i*f,t[1]=a*c+o*f,t[2]=n*-f+i*c,t[3]=a*-f+o*c,t[4]=u,t[5]=s,t},e.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=r[0],c=r[1];return t[0]=n*f,t[1]=a*f,t[2]=i*c,t[3]=o*c,t[4]=u,t[5]=s,t},e.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=r[0],c=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=n*f+i*c+u,t[5]=a*f+o*c+s,t},e.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},e.subtract=a,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],u=t[4],s=t[5],f=e[0],c=e[1],h=e[2],d=e[3],l=e[4],_=e[5];return Math.abs(r-f)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-c)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-h)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-d)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(u-l)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(l))&&Math.abs(s-_)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=n,e.sub=a},function(t,e,r){"use strict";function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=e[4],s=e[5],f=e[6],c=e[7],h=e[8],d=e[9],l=e[10],_=e[11],M=e[12],R=e[13],m=e[14],I=e[15],v=r[0],E=r[1],x=r[2],g=r[3];return t[0]=v*n+E*u+x*h+g*M,t[1]=v*a+E*s+x*d+g*R,t[2]=v*i+E*f+x*l+g*m,t[3]=v*o+E*c+x*_+g*I,v=r[4],E=r[5],x=r[6],g=r[7],t[4]=v*n+E*u+x*h+g*M,t[5]=v*a+E*s+x*d+g*R,t[6]=v*i+E*f+x*l+g*m,t[7]=v*o+E*c+x*_+g*I,v=r[8],E=r[9],x=r[10],g=r[11],t[8]=v*n+E*u+x*h+g*M,t[9]=v*a+E*s+x*d+g*R,t[10]=v*i+E*f+x*l+g*m,t[11]=v*o+E*c+x*_+g*I,v=r[12],E=r[13],x=r[14],g=r[15],t[12]=v*n+E*u+x*h+g*M,t[13]=v*a+E*s+x*d+g*R,t[14]=v*i+E*f+x*l+g*m,t[15]=v*o+E*c+x*_+g*I,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,r,n,a,o,u,s,f,c,h,d,l,_,M,R){var m=new i.ARRAY_TYPE(16);return m[0]=t,m[1]=e,m[2]=r,m[3]=n,m[4]=a,m[5]=o,m[6]=u,m[7]=s,m[8]=f,m[9]=c,m[10]=h,m[11]=d,m[12]=l,m[13]=_,m[14]=M,m[15]=R,m},e.set=function(t,e,r,n,a,i,o,u,s,f,c,h,d,l,_,M,R){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=s,t[8]=f,t[9]=c,t[10]=h,t[11]=d,t[12]=l,t[13]=_,t[14]=M,t[15]=R,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],f=e[7],c=e[8],h=e[9],d=e[10],l=e[11],_=e[12],M=e[13],R=e[14],m=e[15],I=r*u-n*o,v=r*s-a*o,E=r*f-i*o,x=n*s-a*u,g=n*f-i*u,A=a*f-i*s,T=c*M-h*_,b=c*R-d*_,p=c*m-l*_,w=h*R-d*M,y=h*m-l*M,U=d*m-l*R,L=I*U-v*y+E*w+x*p-g*b+A*T;return L?(L=1/L,t[0]=(u*U-s*y+f*w)*L,t[1]=(a*y-n*U-i*w)*L,t[2]=(M*A-R*g+m*x)*L,t[3]=(d*g-h*A-l*x)*L,t[4]=(s*p-o*U-f*b)*L,t[5]=(r*U-a*p+i*b)*L,t[6]=(R*E-_*A-m*v)*L,t[7]=(c*A-d*E+l*v)*L,t[8]=(o*y-u*p+f*T)*L,t[9]=(n*p-r*y-i*T)*L,t[10]=(_*g-M*E+m*I)*L,t[11]=(h*E-c*g-l*I)*L,t[12]=(u*b-o*w-s*T)*L,t[13]=(r*w-n*b+a*T)*L,t[14]=(M*v-_*x-R*I)*L,t[15]=(c*x-h*v+d*I)*L,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],f=e[7],c=e[8],h=e[9],d=e[10],l=e[11],_=e[12],M=e[13],R=e[14],m=e[15];return t[0]=u*(d*m-l*R)-h*(s*m-f*R)+M*(s*l-f*d),t[1]=-(n*(d*m-l*R)-h*(a*m-i*R)+M*(a*l-i*d)),t[2]=n*(s*m-f*R)-u*(a*m-i*R)+M*(a*f-i*s),t[3]=-(n*(s*l-f*d)-u*(a*l-i*d)+h*(a*f-i*s)),t[4]=-(o*(d*m-l*R)-c*(s*m-f*R)+_*(s*l-f*d)),t[5]=r*(d*m-l*R)-c*(a*m-i*R)+_*(a*l-i*d),t[6]=-(r*(s*m-f*R)-o*(a*m-i*R)+_*(a*f-i*s)),t[7]=r*(s*l-f*d)-o*(a*l-i*d)+c*(a*f-i*s),t[8]=o*(h*m-l*M)-c*(u*m-f*M)+_*(u*l-f*h),t[9]=-(r*(h*m-l*M)-c*(n*m-i*M)+_*(n*l-i*h)),t[10]=r*(u*m-f*M)-o*(n*m-i*M)+_*(n*f-i*u),t[11]=-(r*(u*l-f*h)-o*(n*l-i*h)+c*(n*f-i*u)),t[12]=-(o*(h*R-d*M)-c*(u*R-s*M)+_*(u*d-s*h)),t[13]=r*(h*R-d*M)-c*(n*R-a*M)+_*(n*d-a*h),t[14]=-(r*(u*R-s*M)-o*(n*R-a*M)+_*(n*s-a*u)),t[15]=r*(u*d-s*h)-o*(n*d-a*h)+c*(n*s-a*u),t},e.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],f=t[8],c=t[9],h=t[10],d=t[11],l=t[12],_=t[13],M=t[14],R=t[15];return(e*o-r*i)*(h*R-d*M)-(e*u-n*i)*(c*R-d*_)+(e*s-a*i)*(c*M-h*_)+(r*u-n*o)*(f*R-d*l)-(r*s-a*o)*(f*M-h*l)+(n*s-a*u)*(f*_-c*l)},e.multiply=n,e.translate=function(t,e,r){var n=r[0],a=r[1],i=r[2],o=void 0,u=void 0,s=void 0,f=void 0,c=void 0,h=void 0,d=void 0,l=void 0,_=void 0,M=void 0,R=void 0,m=void 0;return e===t?(t[12]=e[0]*n+e[4]*a+e[8]*i+e[12],t[13]=e[1]*n+e[5]*a+e[9]*i+e[13],t[14]=e[2]*n+e[6]*a+e[10]*i+e[14],t[15]=e[3]*n+e[7]*a+e[11]*i+e[15]):(o=e[0],u=e[1],s=e[2],f=e[3],c=e[4],h=e[5],d=e[6],l=e[7],_=e[8],M=e[9],R=e[10],m=e[11],t[0]=o,t[1]=u,t[2]=s,t[3]=f,t[4]=c,t[5]=h,t[6]=d,t[7]=l,t[8]=_,t[9]=M,t[10]=R,t[11]=m,t[12]=o*n+c*a+_*i+e[12],t[13]=u*n+h*a+M*i+e[13],t[14]=s*n+d*a+R*i+e[14],t[15]=f*n+l*a+m*i+e[15]),t},e.scale=function(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,r,n){var a=n[0],o=n[1],u=n[2],s=Math.sqrt(a*a+o*o+u*u),f=void 0,c=void 0,h=void 0,d=void 0,l=void 0,_=void 0,M=void 0,R=void 0,m=void 0,I=void 0,v=void 0,E=void 0,x=void 0,g=void 0,A=void 0,T=void 0,b=void 0,p=void 0,w=void 0,y=void 0,U=void 0,L=void 0,P=void 0,S=void 0;return Math.abs(s)<i.EPSILON?null:(s=1/s,a*=s,o*=s,u*=s,f=Math.sin(r),c=Math.cos(r),h=1-c,d=e[0],l=e[1],_=e[2],M=e[3],R=e[4],m=e[5],I=e[6],v=e[7],E=e[8],x=e[9],g=e[10],A=e[11],T=a*a*h+c,b=o*a*h+u*f,p=u*a*h-o*f,w=a*o*h-u*f,y=o*o*h+c,U=u*o*h+a*f,L=a*u*h+o*f,P=o*u*h-a*f,S=u*u*h+c,t[0]=d*T+R*b+E*p,t[1]=l*T+m*b+x*p,t[2]=_*T+I*b+g*p,t[3]=M*T+v*b+A*p,t[4]=d*w+R*y+E*U,t[5]=l*w+m*y+x*U,t[6]=_*w+I*y+g*U,t[7]=M*w+v*y+A*U,t[8]=d*L+R*P+E*S,t[9]=l*L+m*P+x*S,t[10]=_*L+I*P+g*S,t[11]=M*L+v*P+A*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],u=e[6],s=e[7],f=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+f*n,t[5]=o*a+c*n,t[6]=u*a+h*n,t[7]=s*a+d*n,t[8]=f*a-i*n,t[9]=c*a-o*n,t[10]=h*a-u*n,t[11]=d*a-s*n,t},e.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],u=e[2],s=e[3],f=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-f*n,t[1]=o*a-c*n,t[2]=u*a-h*n,t[3]=s*a-d*n,t[8]=i*n+f*a,t[9]=o*n+c*a,t[10]=u*n+h*a,t[11]=s*n+d*a,t},e.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],u=e[2],s=e[3],f=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+f*n,t[1]=o*a+c*n,t[2]=u*a+h*n,t[3]=s*a+d*n,t[4]=f*a-i*n,t[5]=c*a-o*n,t[6]=h*a-u*n,t[7]=d*a-s*n,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,r){var n=r[0],a=r[1],o=r[2],u=Math.sqrt(n*n+a*a+o*o),s=void 0,f=void 0,c=void 0;return Math.abs(u)<i.EPSILON?null:(u=1/u,n*=u,a*=u,o*=u,s=Math.sin(e),f=Math.cos(e),c=1-f,t[0]=n*n*c+f,t[1]=a*n*c+o*s,t[2]=o*n*c-a*s,t[3]=0,t[4]=n*a*c-o*s,t[5]=a*a*c+f,t[6]=o*a*c+n*s,t[7]=0,t[8]=n*o*c+a*s,t[9]=a*o*c-n*s,t[10]=o*o*c+f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=n+n,s=a+a,f=i+i,c=n*u,h=n*s,d=n*f,l=a*s,_=a*f,M=i*f,R=o*u,m=o*s,I=o*f;return t[0]=1-(l+M),t[1]=h+I,t[2]=d-m,t[3]=0,t[4]=h-I,t[5]=1-(c+M),t[6]=_+R,t[7]=0,t[8]=d+m,t[9]=_-R,t[10]=1-(c+l),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],o=e[5],u=e[6],s=e[8],f=e[9],c=e[10];return t[0]=Math.sqrt(r*r+n*n+a*a),t[1]=Math.sqrt(i*i+o*o+u*u),t[2]=Math.sqrt(s*s+f*f+c*c),t},e.getRotation=function(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},e.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],u=e[3],s=a+a,f=i+i,c=o+o,h=a*s,d=a*f,l=a*c,_=i*f,M=i*c,R=o*c,m=u*s,I=u*f,v=u*c,E=n[0],x=n[1],g=n[2];return t[0]=(1-(_+R))*E,t[1]=(d+v)*E,t[2]=(l-I)*E,t[3]=0,t[4]=(d-v)*x,t[5]=(1-(h+R))*x,t[6]=(M+m)*x,t[7]=0,t[8]=(l+I)*g,t[9]=(M-m)*g,t[10]=(1-(h+_))*g,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var i=e[0],o=e[1],u=e[2],s=e[3],f=i+i,c=o+o,h=u+u,d=i*f,l=i*c,_=i*h,M=o*c,R=o*h,m=u*h,I=s*f,v=s*c,E=s*h,x=n[0],g=n[1],A=n[2],T=a[0],b=a[1],p=a[2];return t[0]=(1-(M+m))*x,t[1]=(l+E)*x,t[2]=(_-v)*x,t[3]=0,t[4]=(l-E)*g,t[5]=(1-(d+m))*g,t[6]=(R+I)*g,t[7]=0,t[8]=(_+v)*A,t[9]=(R-I)*A,t[10]=(1-(d+M))*A,t[11]=0,t[12]=r[0]+T-(t[0]*T+t[4]*b+t[8]*p),t[13]=r[1]+b-(t[1]*T+t[5]*b+t[9]*p),t[14]=r[2]+p-(t[2]*T+t[6]*b+t[10]*p),t[15]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,u=n+n,s=a+a,f=r*o,c=n*o,h=n*u,d=a*o,l=a*u,_=a*s,M=i*o,R=i*u,m=i*s;return t[0]=1-h-_,t[1]=c+m,t[2]=d-R,t[3]=0,t[4]=c-m,t[5]=1-f-_,t[6]=l+M,t[7]=0,t[8]=d+R,t[9]=l-M,t[10]=1-f-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,r,n,a,i,o){var u=1/(r-e),s=1/(a-n),f=1/(i-o);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(a+n)*s,t[10]=(o+i)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*f,t[15]=0,t},e.perspective=function(t,e,r,n,a){var i=1/Math.tan(e/2),o=1/(n-a);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*o,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(o+u),f=2/(a+i);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=-(o-u)*s*.5,t[9]=(a-i)*f*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},e.ortho=function(t,e,r,n,a,i,o){var u=1/(e-r),s=1/(n-a),f=1/(i-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+r)*u,t[13]=(a+n)*s,t[14]=(o+i)*f,t[15]=1,t},e.lookAt=function(t,e,r,n){var a=void 0,o=void 0,u=void 0,s=void 0,f=void 0,c=void 0,h=void 0,d=void 0,l=void 0,_=void 0,M=e[0],R=e[1],m=e[2],I=n[0],v=n[1],E=n[2],x=r[0],g=r[1],A=r[2];return Math.abs(M-x)<i.EPSILON&&Math.abs(R-g)<i.EPSILON&&Math.abs(m-A)<i.EPSILON?mat4.identity(t):(h=M-x,d=R-g,l=m-A,_=1/Math.sqrt(h*h+d*d+l*l),h*=_,d*=_,l*=_,a=v*l-E*d,o=E*h-I*l,u=I*d-v*h,(_=Math.sqrt(a*a+o*o+u*u))?(_=1/_,a*=_,o*=_,u*=_):(a=0,o=0,u=0),s=d*u-l*o,f=l*a-h*u,c=h*o-d*a,(_=Math.sqrt(s*s+f*f+c*c))?(_=1/_,s*=_,f*=_,c*=_):(s=0,f=0,c=0),t[0]=a,t[1]=s,t[2]=h,t[3]=0,t[4]=o,t[5]=f,t[6]=d,t[7]=0,t[8]=u,t[9]=c,t[10]=l,t[11]=0,t[12]=-(a*M+o*R+u*m),t[13]=-(s*M+f*R+c*m),t[14]=-(h*M+d*R+l*m),t[15]=1,t)},e.targetTo=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],u=n[0],s=n[1],f=n[2],c=a-r[0],h=i-r[1],d=o-r[2],l=c*c+h*h+d*d;l>0&&(l=1/Math.sqrt(l),c*=l,h*=l,d*=l);var _=s*d-f*h,M=f*c-u*d,R=u*h-s*c;return t[0]=_,t[1]=M,t[2]=R,t[3]=0,t[4]=h*R-d*M,t[5]=d*_-c*R,t[6]=c*M-h*_,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},e.subtract=a,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],u=t[4],s=t[5],f=t[6],c=t[7],h=t[8],d=t[9],l=t[10],_=t[11],M=t[12],R=t[13],m=t[14],I=t[15],v=e[0],E=e[1],x=e[2],g=e[3],A=e[4],T=e[5],b=e[6],p=e[7],w=e[8],y=e[9],U=e[10],L=e[11],P=e[12],S=e[13],D=e[14],N=e[15];return Math.abs(r-v)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-E)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(a-x)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-g)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(u-A)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(s-T)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(f-b)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(c-p)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(h-w)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(d-y)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(l-U)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(U))&&Math.abs(_-L)<=i.EPSILON*Math.max(1,Math.abs(_),Math.abs(L))&&Math.abs(M-P)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(R-S)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(S))&&Math.abs(m-D)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(I-N)<=i.EPSILON*Math.max(1,Math.abs(I),Math.abs(N))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.mul=n,e.sub=a},function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function a(){var t=new f.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function i(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function o(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],u=r[0],s=r[1],f=r[2],c=r[3];return t[0]=n*c+o*u+a*f-i*s,t[1]=a*c+o*s+i*u-n*f,t[2]=i*c+o*f+n*s-a*u,t[3]=o*c-n*u-a*s-i*f,t}function u(t,e,r,n){var a=e[0],i=e[1],o=e[2],u=e[3],s=r[0],f=r[1],c=r[2],h=r[3],d=void 0,l=void 0,_=void 0,M=void 0,R=void 0;return(l=a*s+i*f+o*c+u*h)<0&&(l=-l,s=-s,f=-f,c=-c,h=-h),1-l>1e-6?(d=Math.acos(l),_=Math.sin(d),M=Math.sin((1-n)*d)/_,R=Math.sin(n*d)/_):(M=1-n,R=n),t[0]=M*a+R*s,t[1]=M*i+R*f,t[2]=M*o+R*c,t[3]=M*u+R*h,t}function s(t,e){var r=e[0]+e[4]+e[8],n=void 0;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*n,n=.5/n,t[3]=(e[3*i+o]-e[3*o+i])*n,t[i]=(e[3*i+a]+e[3*a+i])*n,t[o]=(e[3*o+a]+e[3*a+o])*n}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=a,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=i,e.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},e.multiply=o,e.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+o*u,t[1]=a*s+i*u,t[2]=i*s-a*u,t[3]=o*s-n*u,t},e.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s-i*u,t[1]=a*s+o*u,t[2]=i*s+n*u,t[3]=o*s-a*u,t},e.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+a*u,t[1]=a*s-n*u,t[2]=i*s+o*u,t[3]=o*s-i*u,t},e.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t},e.slerp=u,e.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i,u=o?1/o:0;return t[0]=-r*u,t[1]=-n*u,t[2]=-a*u,t[3]=i*u,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=s,e.fromEuler=function(t,e,r,n){var a=.5*Math.PI/180;e*=a,r*=a,n*=a;var i=Math.sin(e),o=Math.cos(e),u=Math.sin(r),s=Math.cos(r),f=Math.sin(n),c=Math.cos(n);return t[0]=i*s*c-o*u*f,t[1]=o*u*c+i*s*f,t[2]=o*s*f-i*u*c,t[3]=o*s*c+i*u*f,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var f=n(r(0)),c=n(r(1)),h=n(r(2)),d=n(r(3)),l=(e.clone=d.clone,e.fromValues=d.fromValues,e.copy=d.copy,e.set=d.set,e.add=d.add,e.mul=o,e.scale=d.scale,e.dot=d.dot,e.lerp=d.lerp,e.length=d.length),_=(e.len=l,e.squaredLength=d.squaredLength),M=(e.sqrLen=_,e.normalize=d.normalize);e.exactEquals=d.exactEquals,e.equals=d.equals,e.rotationTo=function(){var t=h.create(),e=h.fromValues(1,0,0),r=h.fromValues(0,1,0);return function(n,a,o){var u=h.dot(a,o);return u<-.999999?(h.cross(t,e,a),h.len(t)<1e-6&&h.cross(t,r,a),h.normalize(t,t),i(n,t,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(h.cross(t,a,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+u,M(n,n))}}(),e.sqlerp=function(){var t=a(),e=a();return function(r,n,a,i,o,s){return u(t,n,o,s),u(e,a,i,s),u(r,t,e,2*s*(1-s)),r}}(),e.setAxes=function(){var t=c.create();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],M(e,s(e,t))}}()},function(t,e,r){"use strict";function n(){var t=new h.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function o(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function u(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}function s(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function f(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function c(t){var e=t[0],r=t[1];return e*e+r*r}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=n,e.clone=function(t){var e=new h.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var r=new h.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,r){return t[0]=e,t[1]=r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},e.subtract=a,e.multiply=i,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},e.distance=u,e.squaredDistance=s,e.length=f,e.squaredLength=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},e.lerp=function(t,e,r,n){var a=e[0],i=e[1];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t},e.random=function(t,e){e=e||1;var r=2*h.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},e.transformMat2=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t},e.transformMat2d=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t},e.transformMat3=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t},e.transformMat4=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var r=t[0],n=t[1],a=e[0],i=e[1];return Math.abs(r-a)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-i)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))};var h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(0));e.len=f,e.sub=a,e.mul=i,e.div=o,e.dist=u,e.sqrDist=s,e.sqrLen=c,e.forEach=function(){var t=n();return function(e,r,n,a,i,o){var u=void 0,s=void 0;for(r||(r=2),n||(n=0),s=a?Math.min(a*r+n,e.length):e.length,u=n;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],i(t,t,o),e[u]=t[0],e[u+1]=t[1];return e}}()}])});var RedShaderInfo;!function(){var t,e,r,n;(RedShaderInfo=function(a,i,o,u){if(!(this instanceof RedShaderInfo))return new RedShaderInfo(a,i,o,u);if(!(a instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof i)throw"key - 문자열만 허용됩니다.";if("string"!=typeof o)throw"type - 문자열만 허용됩니다.";if("string"!=typeof u)throw"source - 문자열만 허용됩니다.";if(a.__datas.shaderInfo||(a.__datas.shaderInfo={},a.__datas.shaderInfo[RedShaderInfo.FRAGMENT_SHADER]={},a.__datas.shaderInfo[RedShaderInfo.VERTEX_SHADER]={}),(n=a.__datas.shaderInfo)[o][i])throw i+"는 "+o+"정보에 이미 존재하는 RedShaderInfo 입니다.";switch(e=a.gl,o){case RedShaderInfo.VERTEX_SHADER:r=e.createShader(e.VERTEX_SHADER);break;case RedShaderInfo.FRAGMENT_SHADER:r=e.createShader(e.FRAGMENT_SHADER);break;default:throw"쉐이더 타입을 확인하세요!"}if(e.shaderSource(r,u),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw"쉐이더 컴파일에 실패하였습니다.";(t=(t=u.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;/g))||[]).forEach(function(e,r){t[r]=e.trim().replace(";","").split("[")[0]}),this.key=i,this.type=o,this.shader=r,this.parseData=t,this.__UUID=REDGL_UUID++,n[o][i]=this,Object.freeze(this)}).FRAGMENT_SHADER="fragmentShader",RedShaderInfo.VERTEX_SHADER="vertexShader",Object.freeze(RedShaderInfo)}();var RedProgramInfo;!function(){var t,e,r,n,a,i;i=[],RedProgramInfo=function(o,u,s,f,c){if(!(this instanceof RedProgramInfo))return new RedProgramInfo(o,u,s,f,c);if(!(o instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof u)throw"key - 문자열만 허용됩니다.";if(!c)throw"makeUniformValue - 반드시 정의해야합니다.";if(!s instanceof RedShaderInfo)throw"vShaderInfo - RedShaderInfo만 허용됩니다.";if(!f instanceof RedShaderInfo)throw"fShaderInfo - RedShaderInfo만 허용됩니다.";if(o.__datas.RedProgramInfo||(o.__datas.RedProgramInfo={}),(e=o.__datas.RedProgramInfo)[u])return e[u];if(t=o.gl,this.key=u,this.attributes={},this.uniforms={},a=this,r=t.createProgram(),t.attachShader(r,s.shader),t.attachShader(r,f.shader),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw"프로그램을 초기화 할 수 없습니다."+t.useProgram(r);n={},i.length=0,i.push(s,f),i.forEach(function(e){e.parseData&&e.parseData.forEach(function(e){var n;n={},"attribute"==(e=e.split(" "))[0]?(n.location=t.getAttribLocation(r,e[2]),n.type=e[1],a.attributes[e[2]]=n):(n.location=t.getUniformLocation(r,e[2]),n.type=e[1],a.uniforms[e[2]]=n)})}),this.program=r,this.shaderInfos={vShaderInfo:s,fShaderInfo:f},this.__UUID=REDGL_UUID++,this.makeUniformValue=c,e[u]=this,Object.freeze(this)},Object.freeze(RedProgramInfo)}();var RedBaseCameraInfo;!function(){var t;RedBaseCameraInfo=function(e,r){if(!(this instanceof RedBaseCameraInfo))return new RedBaseCameraInfo(e,r);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof r)throw"key는 문자열만 허용됩니다.";if(e.__datas.RedBaseCameraInfo||(e.__datas.RedBaseCameraInfo={}),(t=e.__datas.RedBaseCameraInfo)[r])throw r+"는 이미 존재하는 RedBaseCameraInfo 입니다.";Object.defineProperty(this,"uPMatrix",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"uCameraMatrix",{value:mat4.create(),enumerable:!0}),this.fov=45,this.aspect=.1,this.near=.1,this.far=1e3,Object.defineProperty(this,"__desiredCoords",{value:new Float32Array([0,0,0]),enumerable:!0}),Object.defineProperty(this,"__desiredRotation",{value:new Float32Array([0,0,0]),enumerable:!0}),this.__UUID=REDGL_UUID++,this.__canvas=e.__canvas,this.update(),t[r]=this};mat4.create();RedBaseCameraInfo.prototype={setPosition:function(t,e,r){return this.__desiredCoords[0]=t,this.__desiredCoords[1]=e,this.__desiredCoords[2]=r,this},moveForward:function(t){},moveBack:function(t){},moveLeft:function(t){},moveRight:function(t){},moveUp:function(t){},moveDown:function(t){},lookAt:function(){var t=new Float32Array([0,1,0]);return function(e){mat4.lookAt(this.uCameraMatrix,this.__desiredCoords,e,t)}}(),update:function(){return this.aspect=this.__canvas.clientWidth/this.__canvas.clientHeight,mat4.identity(this.uPMatrix),mat4.perspective(this.uPMatrix,this.fov*Math.PI/180,this.aspect,this.near,this.far),this}},Object.freeze(RedBaseCameraInfo)}();var RedCubeTextureInfo;!function(){var t;(RedCubeTextureInfo=function(e,r){if(!(this instanceof RedCubeTextureInfo))return new RedCubeTextureInfo(e,r);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(!(r instanceof Array))throw"srcList는 Array만 허용됩니다.";var n,a;a=this,t=e.gl,n=0;var i=r.length;for(this.__imgList=[];i--;){var o=new Image;o.src=r[i],o.onload=function(){n++,this.onload=null,6==n&&a.__allLoaed(t)},this.__imgList[i]=o}this.__targetIndex=RedTextureIndex.CREATE,this.loaded=0,this.actived=0,this.__webglCubeTexture=1,this.__UUID=REDGL_UUID++,t.activeTexture(t.TEXTURE0+RedTextureIndex.CREATE),this.texture=t.createTexture()}).prototype.__allLoaed=function(){this.loaded=1,this.__targetIndex=RedTextureIndex.CUBE,t.activeTexture(t.TEXTURE0+RedTextureIndex.CREATE),t.bindTexture(t.TEXTURE_CUBE_MAP,this.texture),this.__imgList.forEach(function(e,r){t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}),t.texParameterf(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_CUBE_MAP)}}();var RedBufferInfo;!function(){var t,e,r,n;(RedBufferInfo=function(a,i,o,u,s,f,c,h,d,l,_,M){if(!(this instanceof RedBufferInfo))return new RedBufferInfo(a,i,o,u,s,f,c,h,d,l,_,M);if(!(a instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof i)throw"bufferType - 문자열만 허용됩니다.";if("string"!=typeof o)throw"key - 문자열만 허용됩니다.";if(i==RedBufferInfo.ARRAY_BUFFER&&"string"!=typeof u)throw"pointer - 문자열만 허용됩니다.";if("number"!=typeof f||f!=parseInt(f))throw"pointSize - Integer만 허용됩니다.";if(a.__datas.RedBufferInfo||(a.__datas.RedBufferInfo={}),(e=a.__datas.RedBufferInfo)[o])throw o+"는 이미 존재하는 RedBufferInfo 입니다.";switch(t=a.gl,n=t.createBuffer(),r=i,i){case RedBufferInfo.ARRAY_BUFFER:if(i=t.ARRAY_BUFFER,!(s instanceof Float32Array||s instanceof Float64Array))throw"TypedArray형식을 사용해야합니다.";break;case RedBufferInfo.ELEMENT_ARRAY_BUFFER:if(i=t.ELEMENT_ARRAY_BUFFER,!(s instanceof Uint8Array||s instanceof Uint16Array||s instanceof Uint32Array||s instanceof Int8Array||s instanceof Int16Array||s instanceof Int32Array))throw"TypedArray형식을 사용해야합니다.";break;default:throw"지원하지 않는 버퍼타입입니다. "}if(t.bindBuffer(i,n),t.bufferData(i,s,M=M||t.STATIC_DRAW),this.shaderPointerKey=u,!h)throw"버퍼데이터의 형식을 지정해주세요";var R=!1;if(s instanceof Int8Array?R=h==t.BYTE:s instanceof Uint8Array?R=h==t.UNSIGNED_BYTE:s instanceof Int16Array?R=h==t.SHORT:s instanceof Uint16Array?R=h==t.UNSIGNED_SHORT:s instanceof Int32Array?R=h==t.INT:s instanceof Uint32Array?R=h==t.UNSIGNED_INT:s instanceof Float32Array&&(R=h==t.FLOAT),!R)throw"arrayData 형식과 arrayType이 맞지않습니다.";if(this.arrayType=h,!f)throw"pointSize를 입력하세요";if(this.pointSize=f,"number"!=typeof(c=c||s.length/f)||c!=parseInt(c))throw"pointNum - Integer만 허용됩니다.";if(this.pointNum=c,this.normalize=d||!1,"number"!=typeof(l=l||0)||l!=parseInt(l))throw"stride - Integer만 허용됩니다.";if("number"!=typeof(_=_||0)||_!=parseInt(_))throw"offset - Integer만 허용됩니다.";this.stride=l,this.offset=_,this.enabled=0,this.key=o,this.bufferType=r,this.buffer=n,this.drawMode=M,this.__UUID=REDGL_UUID++,e[o]=this}).ARRAY_BUFFER="arrayBuffer",RedBufferInfo.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBufferInfo)}();var RedFixedAttributeKey;RedFixedAttributeKey={aVertexPosition:"aVertexPosition",aTexcoord:"aTexcoord",aVertexNormal:"aVertexNormal"},Object.freeze(RedFixedAttributeKey);var RedGeometryInfo;!function(){var t,e,r;RedGeometryInfo=function(n,a,i,o,u,s){if(!(this instanceof RedGeometryInfo))return new RedGeometryInfo(n,a,i,o,u,s);if(!(n instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(i&&!(i instanceof RedBufferInfo))throw"verticesBufferInfo는 RedBufferInfo만 가능합니다.";if(o&&!(o instanceof RedBufferInfo))throw"indicesBufferInfo RedBufferInfo만 가능합니다.";if(u&&!(u instanceof RedBufferInfo))throw"texcoordBufferInfo RedBufferInfo만 가능합니다.";if(s&&!(s instanceof RedBufferInfo))throw"normalBufferInfo RedBufferInfo만 가능합니다.";if(i&&i.bufferType!=RedBufferInfo.ARRAY_BUFFER)throw"verticesBufferInfo ARRAY_BUFFER 가능합니다.";if(o&&o.bufferType!=RedBufferInfo.ELEMENT_ARRAY_BUFFER)throw"indicesBufferInfo는 ELEMENT_ARRAY_BUFFER만 가능합니다.";if(u&&u.bufferType!=RedBufferInfo.ARRAY_BUFFER)throw"texcoordBufferInfo ARRAY_BUFFER 가능합니다.";if(s&&s.bufferType!=RedBufferInfo.ARRAY_BUFFER)throw"normalBufferInfo ARRAY_BUFFER 가능합니다.";if(n.__datas.RedGeometryInfo||(n.__datas.RedGeometryInfo={}),(e=n.__datas.RedGeometryInfo)[a])throw a+"는 이미 존재하는 RedGeometryInfo 입니다.";if(t=n.gl,this.attributes={},this.indices=null,this.key=a,i){if(i.shaderPointerKey!=RedFixedAttributeKey.aVertexPosition)throw"verticesBufferInfo의 shaderPointerKey는 aVertexPosition만 가질수있습니다.";this.attributes.vertexPosition=i}if(u){if(u.shaderPointerKey!=RedFixedAttributeKey.aTexcoord)throw"texcoordBufferInfo의 shaderPointerKey는 aTexcoord만 가질수있습니다.";this.attributes.texcoord=u}if(s){if(s.shaderPointerKey!=RedFixedAttributeKey.aVertexNormal)throw"normalBufferInfo의 shaderPointerKey는 aVertexNormal만 가질수있습니다.";this.attributes.normal=s}this.__attributeList=[];for(r in this.attributes)this.__attributeList.push(this.attributes[r]);this.indices=o,this.__UUID=REDGL_UUID++,e[a]=this},Object.freeze(RedGeometryInfo)}();var RedMeshInfo;!function(){var t,e;RedMeshInfo=function(r,n,a,i){if(!(this instanceof RedMeshInfo))return new RedMeshInfo(r,n,a,i);if(!(r instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof n)throw"key - 문자열만 허용됩니다.";if(!(a instanceof RedGeometryInfo))throw"geometryInfo - RedGeometryInfo만 허용됩니다.";if(!(i instanceof RedMaterialInfo))throw"materialInfo - RedMaterialInfo만 허용됩니다.";if(t=r.gl,r.__datas.RedMeshInfo||(r.__datas.RedMeshInfo={}),(e=r.__datas.RedMeshInfo)[n])throw n+"는 이미 존재하는 RedMeshInfo 입니다.";RedMeshBaseInfo.call(this,r),this.geometryInfo=a,this.materialInfo=i,e[n]=this},Object.freeze(RedMeshInfo)}();var RedMeshBaseInfo;!function(){var t;RedMeshBaseInfo=function(e){t=e.gl,Object.defineProperty(this,"uMVMatrix",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"uNMatrix",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"position",{value:new Float32Array([0,0,0]),enumerable:!0}),Object.defineProperty(this,"rotation",{value:new Float32Array([0,0,0]),enumerable:!0}),Object.defineProperty(this,"scale",{value:new Float32Array([1,1,1]),enumerable:!0}),this.geometryInfo=null,this.materialInfo=null,this.drawMode=t.TRIANGLES,this.useCullFace=!0,this.cullFace=t.BACK,this.useBlendMode=!0,this.blendFactor1=t.ONE,this.blendFactor2=t.ONE_MINUS_SRC_ALPHA,this.useDepthTest=!0,this.depthTestFunc=t.LESS,this.children=[],this.__UUID=REDGL_UUID++},Object.freeze(RedMeshBaseInfo)}();var RedPrimitive;!function(){var t,e,r,n;n=function(t){return t.__datas.RedPrimitive||(t.__datas.RedPrimitive={}),t.__datas.RedPrimitive},r=function(t,e,r,n,a,i){return r=new Float32Array(r),n=new Uint16Array(n),a=new Float32Array(a),i=new Float32Array(i),r=t.createArrayBufferInfo(e+"_vertices",RedFixedAttributeKey.aVertexPosition,r,3,r.length/3,t.gl.FLOAT),n=t.createIndexBufferInfo(e+"_indices",n,1,n.length,t.gl.UNSIGNED_SHORT),a&&(a=t.createArrayBufferInfo(e+"_uvs",RedFixedAttributeKey.aTexcoord,a,2,a.length/2,t.gl.FLOAT)),i&&(i=t.createArrayBufferInfo(e+"_normals",RedFixedAttributeKey.aVertexNormal,i,3,i.length/3,t.gl.FLOAT)),t.createGeometryInfo(e,r,n,a,i)},(RedPrimitive={}).plane=function(){var a,i,o,u,s,f,c,h,d,l,_,M,R,m,I,v;return function E(x,g,A,T,b){if(!(this instanceof E))return new E(x,g,A,T,b);if(!(x instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(g=g||1,A=A||1,b=b||1,b=b||1,a=g/2,i=A/2,o=Math.floor(T)||1,u=Math.floor(b)||1,s=o+1,f=u+1,c=g/o,h=A/u,e=n(x),t="RedPrimitivePlane_"+g+"_"+A+"_"+T+"_"+b,e[t])return e[t];var p=[],w=[],y=[],U=[];for(l=0;l<f;l++)for(M=l*h-i,d=0;d<s;d++)_=d*c-a,p.push(_,-M,0),U.push(0,0,1),y.push(d/o,1-l/u);for(l=0;l<u;l++)for(d=0;d<o;d++)R=d+s*l,m=d+s*(l+1),I=d+1+s*(l+1),v=d+1+s*l,w.push(R,m,v,m,I,v);return e[t]=r(x,t,p,w,y,U),e[t]}}(),RedPrimitive.cube=function(){var a,i,o;return o=function(t,e,r,n,o,u,s,f,c,h,d,l,_,M,R){var m,I,v=h/_,E=d/M,x=h/2,g=d/2,A=l/2,T=_+1,b=M+1,p=0,w=0,y=[];for(I=0;I<b;I++){var U=I*E-g;for(m=0;m<T;m++){var L=m*v-x;y[o]=L*f,y[u]=U*c,y[s]=A,t.push(y.x,y.y,y.z),y[o]=0,y[u]=0,y[s]=l>0?1:-1,n.push(y.x,y.y,y.z),r.push(m/_),r.push(1-I/M),p+=1}}for(I=0;I<M;I++)for(m=0;m<_;m++){var P=a+m+T*I,S=a+m+T*(I+1),D=a+(m+1)+T*(I+1),N=a+(m+1)+T*I;e.push(P,S,N),e.push(S,D,N),w+=6}i+=w,a+=p},function u(s,f,c,h,d,l,_){if(!(this instanceof u))return new u(s,f,c,h,d,l,_);if(!(s instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(f=f||1,c=c||1,h=h||1,d=Math.floor(d)||1,l=Math.floor(l)||1,_=Math.floor(_)||1,e=n(s),t="RedPrimitiveCube_"+f+"_"+c+"_"+h+"_"+d+"_"+l+"_"+_,e[t])return e[t];var M=[],R=[],m=[],I=[];return a=0,i=0,o(M,R,m,I,"z","y","x",-1,-1,h,c,f,_,l),o(M,R,m,I,"z","y","x",1,-1,h,c,-f,_,l),o(M,R,m,I,"x","z","y",1,1,f,h,c,d,_),o(M,R,m,I,"x","z","y",1,-1,f,h,-c,d,_),o(M,R,m,I,"x","y","z",1,-1,f,c,h,d,l),o(M,R,m,I,"x","y","z",-1,-1,f,c,-h,d,l),e[t]=r(s,t,M,R,m,I),e[t]}}(),RedPrimitive.grid=function(){var a,i,o,u,s,f,c,h;return function d(l,_,M){if(!(this instanceof d))return new d(l,_,M);if(!(l instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(e=n(l),_=_||50,M=M||50,t="RedPrimitiveFloor_"+_+"_"+M,e[t])return e[t];var R=[],m=[];for(o=2*(a=_)/(i=M),u=0;u<=i;u++)s=u*o,h=6*(f=i+1),R[c=6*u]=-a,R[c+1]=0,R[c+2]=-a+s,R[c+3]=a,R[c+4]=0,R[c+5]=-a+s,R[h+c]=-a+s,R[h+c+1]=0,R[h+c+2]=-a,R[h+c+3]=-a+s,R[h+c+4]=0,R[h+c+5]=a,m[2*u]=2*u,m[2*u+1]=2*u+1,m[2*f+2*u]=2*f+2*u,m[2*f+2*u+1]=2*f+2*u+1;return e[t]=r(l,t,R,m),e[t]}}(),RedPrimitive.sphere=function(){var a,i,o,u,s,f,c,h,d=[],l=new Float32Array([0,0,0]),_=new Float32Array([0,0,0]);return function M(R,m,I,v,E,x,g,A){if(!(this instanceof M))return new M(R,m,I,v,E,x,g,A);if(!(R instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(m=m||1,I=Math.max(3,Math.floor(I)||8),v=Math.max(2,Math.floor(v)||6),E=void 0!==E?E:0,x=void 0!==x?x:2*Math.PI,g=void 0!==g?g:0,A=void 0!==A?A:Math.PI,a=g+A,u=0,d.length=0,l[0]=0,l[1]=0,l[2]=0,_[0]=0,_[1]=0,_[2]=0,e=n(R),t="RedPrimitiveSphere_"+m+"_"+I+"_"+v+"_"+E+"_"+x+"_"+g+"_"+A,e[t])return e[t];var T=[],b=[],p=[],w=[];for(o=0;o<=v;o++){var y=[],U=o/v;for(i=0;i<=I;i++){var L=i/I;l.x=-m*Math.cos(E+L*x)*Math.sin(g+U*A),l.y=m*Math.cos(g+U*A),l.z=m*Math.sin(E+L*x)*Math.sin(g+U*A),T.push(l.x,l.y,l.z),_[0]=l.x,_[1]=l.y,_[2]=l.z,vec3.normalize(_,_),w.push(_[0],_[1],_[2]),p.push(L,1-U),y.push(u++)}d.push(y)}for(o=0;o<v;o++)for(i=0;i<I;i++)s=d[o][i+1],f=d[o][i],c=d[o+1][i],h=d[o+1][i+1],(0!==o||g>0)&&b.push(s,f,h),(o!==v-1||a<Math.PI)&&b.push(f,c,h);return e[t]=r(R,t,T,b,p,w),e[t]}}(),RedPrimitive.cone=function a(i,o,u,s,f,c,h,d){if(!(this instanceof a))return new a(i,o,u,s,f,c,h,d);if(!(i instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(f=c?f:3,c=c||1,s=s||1,u=u||1,o=o||1,e=n(i),t="RedPrimitiveCone_"+o+"_"+u+"_"+s+"_"+f+"_"+c+"_"+h+"_"+d,e[t])return e[t];for(var l=[],_=[],M=[],R=[],m=void 0===h||h,I=void 0===d||d,v=(m?2:0)+(I?2:0),E=f+1,x=Math.atan2(o-u,s),g=Math.cos(x),A=Math.sin(x),T=c+(I?2:0),b=m?-2:0;b<=T;++b){var p,w=b/c,y=s*w;b<0?(y=0,w=1,p=o):b>c?(y=s,w=1,p=u):p=o+b/c*(u-o),-2!==b&&b!==c+2||(p=0,w=0),y-=s/2;for(P=0;P<E;++P){var U=Math.sin(P*Math.PI*2/f),L=Math.cos(P*Math.PI*2/f);l.push(U*p,y,L*p),R.push(b<0||b>c?0:U*g,b<0?-1:b>c?1:A,b<0||b>c?0:L*g),M.push(P/f,1-w)}}for(b=0;b<c+v;++b)for(var P=0;P<f;++P)_.push(E*(b+0)+0+P,E*(b+0)+1+P,E*(b+1)+1+P),_.push(E*(b+0)+0+P,E*(b+1)+1+P,E*(b+1)+0+P);return e[t]=r(i,t,l,_,M,R),e[t]},Object.freeze(RedPrimitive)}();var RedAmbientLightInfo;!function(){var t;(RedAmbientLightInfo=function(e){if(!(this instanceof RedAmbientLightInfo))return new RedAmbientLightInfo(e);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";e.__datas.RedAmbientLightInfo||(e.__datas.RedAmbientLightInfo={}),t=e.__datas.RedAmbientLightInfo,this.color=new Float32Array([.03,.03,.03,1]),this.__UUID=REDGL_UUID++}).TYPE="ambient",Object.freeze(RedAmbientLightInfo)}();var RedDirectionalLightInfo;!function(){var t;(RedDirectionalLightInfo=function(e){if(!(this instanceof RedDirectionalLightInfo))return new RedDirectionalLightInfo(e);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";e.__datas.RedDirectionalLightInfo||(e.__datas.RedDirectionalLightInfo={}),t=e.__datas.RedDirectionalLightInfo,this.color=new Float32Array([1,1,1,1]),this.direction=new Float32Array([0,0,0]),this.__UUID=REDGL_UUID++}).TYPE="directional",Object.freeze(RedDirectionalLightInfo)}();var RedPointLightInfo;!function(){var t;(RedPointLightInfo=function(e){if(!(this instanceof RedPointLightInfo))return new RedPointLightInfo(e);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";e.__datas.RedPointLightInfo||(e.__datas.RedPointLightInfo={}),t=e.__datas.RedPointLightInfo,this.color=new Float32Array([1,1,1,1]),this.position=new Float32Array([0,0,0]),this.radius=1,this.usedebugMode=!1,this.__UUID=REDGL_UUID++,this.__debugMesh=e.createMeshInfo("RedPointLightInfo__debugMesh"+this.__UUID,RedPrimitive.sphere(e,.5,16,16,16),e.createMaterialInfo("color")),this.__debugMesh.children.push(e.createMeshInfo("RedPointLightInfo__debugMesh"+this.__UUID+"_center",RedPrimitive.sphere(e,.01,1,1,1),e.createMaterialInfo("color"))),this.__debugMesh.drawMode=e.gl.LINE_STRIP,this.__debugMesh.children[0].drawMode=e.gl.LINE_STRIP}).TYPE="point",Object.freeze(RedPointLightInfo)}();var RedMaterialInfo;!function(){var t,e,r,n,a,i;n={f:{16:"uniformMatrix4fv",12:"uniformMatrix3fv",8:"uniformMatrix2fv",4:"uniform4fv",3:"uniform3fv",2:"uniform2fv",1:"uniform1fv"},i:{16:"uniformMatrix4iv",12:"uniformMatrix3iv",8:"uniformMatrix2iv",4:"uniform4iv",3:"uniform3iv",2:"uniform2iv",1:"uniform1iv"}},(RedMaterialInfo=function(o,u,s,f,c,h){if(!(this instanceof RedMaterialInfo))return new RedMaterialInfo(o,u,s,f,c,h);if(!(o instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof u)throw"typeName은 문자열만 허용됩니다.";if(t=o.__datas.RedMaterialDefine,!(e=t[u]))throw u+"재질은 존재하지않습니다.";this.programInfo=e.programInfo,s&&(this.uDiffuseTexture=s),f&&(this.uNormalTexture=f),c&&(this.uDisplacementTexture=c),h&&(this.uSpecularTexture=h),this.uniforms=r={},e.programInfo.makeUniformValue(this),this.needUniformList=!0;for(a in r)if((i=r[a])instanceof Float32Array||i instanceof Float64Array)i.__uniformMethod=n.f[i.length],i.__isMatrix=i.__uniformMethod.length>11;else if(i instanceof Uint8Array||i instanceof Uint16Array||i instanceof Uint32Array||i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array)i.__uniformMethod=n.i[i.length],i.__isMatrix=i.__uniformMethod.length>11;else if(null==i);else if("number"==typeof i);else if(i instanceof RedAtlasUVInfo);else if(i instanceof RedTextureInfo||i instanceof RedCubeTextureInfo);else{if(!(i instanceof RedAtlasTextureInfo))throw a+"는 올바르지 않은 타입입니다.";this.uniforms.uAtlascoord=i.atlasUVInfo}this.updateUniformList(),this.__UUID=REDGL_UUID++}).prototype.updateUniformList=function(){if(this.needUniformList){this.__uniformList=[];var t=this.uniforms,e=this.programInfo.uniforms;for(a in t)this.__uniformList.push({key:a,type:e[a].type,value:t[a],location:e[a].location}),this[a]=t[a];this.needUniformList=!1}},Object.freeze(RedMaterialInfo)}();var RedMaterialDefine;!function(){var t,e;RedMaterialDefine=function(r,n){if(!(this instanceof RedMaterialDefine))return new RedMaterialDefine(r,n);if(!(r instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(!(n instanceof RedProgramInfo))throw"RedProgramInfo 인스턴스만 허용됩니다.";if(r.__datas.RedMaterialDefine||(r.__datas.RedMaterialDefine={}),e=n.key,(t=r.__datas.RedMaterialDefine)[e])throw e+"는 이미 존재하는 RedMaterialDefine 입니다.";this.programInfo=n,this.__UUID=REDGL_UUID++,t[e]=this,Object.freeze(this)},Object.freeze(RedMaterialDefine)}();var RedSceneInfo;!function(){var t;(RedSceneInfo=function(e,r,n){if(!(this instanceof RedSceneInfo))return new RedSceneInfo(e,r,n);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof r)throw"key는 문자열만 허용됩니다.";if(!(n instanceof RedBaseCameraInfo))throw"camera는 RedBaseCameraInfo 인스턴스만 허용됩니다.";if(e.__datas.RedSceneInfo||(e.__datas.RedSceneInfo={}),(t=e.__datas.RedSceneInfo)[r])throw r+"는 이미 존재하는 RedSceneInfo 입니다.";this.children=[],this.camera=n,this.lights={ambient:[],directional:[],point:[],spot:[]},this.__UUID=REDGL_UUID++,t[r]=this,Object.seal(RedSceneInfo)}).prototype={setSkyBox:function(t){this.skyBox=t},setGrid:function(t){this.grid=t},addLight:function(){var t;return function(e){if(e instanceof RedDirectionalLightInfo){if(16==(t=this.lights[RedDirectionalLightInfo.TYPE]).length)throw"직사광 최대갯수는 16개입니다.";t.push(e)}else if(e instanceof RedPointLightInfo){if(16==(t=this.lights[RedPointLightInfo.TYPE]).length)throw"포인트라이트 최대갯수는 16개입니다.";t.push(e)}else if(e instanceof RedAmbientLightInfo)(t=this.lights[RedAmbientLightInfo.TYPE])[0]=e;else{if(!(e instanceof RedSpotLightInfo))throw"등록할수 없는 타입입니다.";if(16==(t=this.lights[RedSpotLightInfo.TYPE]).length)throw"스폿라이트 최대갯수는 16개입니다.";t.push(e)}}}()},Object.freeze(RedSceneInfo)}();var RedTextureInfo;!function(){var t;(RedTextureInfo=function(e,r,n,a,i,o){if(!(this instanceof RedTextureInfo))return new RedTextureInfo(e,r,n,a,i,o);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(void 0!=r&&"string"!=typeof r&&!(r instanceof Element&&"CANVAS"==r.nodeName))throw"src는 문자열과 캔버스 오브젝트만 허용됩니다.";var u,s,f;f=this,t=e.gl,a=a||t.RGBA,i=i||t.RGBA,o=o||t.UNSIGNED_BYTE,n=n||RedTextureIndex.DIFFUSE,u=t.createTexture(),t.activeTexture(t.TEXTURE0+RedTextureIndex.CREATE),t.bindTexture(t.TEXTURE_2D,u),t.texImage2D(t.TEXTURE_2D,0,a,1,1,0,i,o,new Uint8Array(222,222,222,255)),s=new Image,void 0!=r&&(s.src=r instanceof Element?r.toDataURL():r),s.crossOrigin="anonymous",s.addEventListener("load",function(){f.loaded=1,f.__targetIndex=n,t.bindTexture(t.TEXTURE_2D,f.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,f.__img),t.texParameterf(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D)}),this.__img=s,this.__targetIndex=RedTextureIndex.CREATE,this.loaded=0,this.actived=0,this.__webglTexture=1,this.__UUID=REDGL_UUID++,this.texture=u}).prototype.updateTexture=function(t){self.loaded=0,this.__img.src=t instanceof Element?t.toDataURL():t}}();var RedTextureIndex;RedTextureIndex={CREATE:0,DIFFUSE:1,CUBE:2,NORMAL:3,DISPLACEMENT:4,SPECULAR:5,ETC_VERTEX_1:10,ETC_VERTEX_2:11,ETC_FRAGMENT_1:12,ETC_FRAGMENT_2:13},Object.freeze(RedTextureIndex);var RedAtlasUVInfo;RedAtlasUVInfo=function(t){if(!(this instanceof RedAtlasUVInfo))return new RedAtlasUVInfo(t);if(!(t instanceof Array))throw"uvArray는 Array만 허용합니다.";this.value=new Float32Array(t),this.value.__UUID=this.__UUID=REDGL_UUID++,Object.freeze(this)};var RedAtlasInfo;RedAtlasInfo=function(t,e){if(!(this instanceof RedAtlasInfo))return new RedAtlasInfo(t,e);if(!(t instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";this.atlas=e,this.textureInfo=null,Object.seal(this)};var RedAtlasTextureManager;!function(){var t,e,r,n,a,i,o,u,s;n={},r=[],u=function(n){var u;if(n&&(n.width>t||n.height>t))throw t+" - 최대 허용사이즈보다 이미지가 큽니다.";(u=document.createElement("canvas")).width=t,u.height=t,u.style.background="transparent",u.style.margin="3px",u.style.display="inline-block",(o=new Atlas(u)).atlasInfo=RedAtlasInfo(a,o),++i==e&&(i=e-parseInt(e/4)),o.__targetIndex=i,r.push(o.atlasInfo)},s=function(t){var e,a,i=(o=r[0].atlas).pack(t);if(!1===i){for(e=0,a=r.length,e;e<a&&(o=r[e].atlas,!(i=o.pack(t)));e++);!1===i&&(u(t),i=o.pack(t))}return n[t.id]=new RedAtlasTextureInfo(o.uv()[t.id],o.atlasInfo),i},(RedAtlasTextureManager=function(f,c,h){if(!(this instanceof RedAtlasTextureManager))return new RedAtlasTextureManager(f,c,h);if(!(f instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";c instanceof Array||(c=[c]),a=f,t=f.detect.MAX_TEXTURE_SIZE,e=f.detect.MAX_TEXTURE_IMAGE_UNITS,void 0==i&&(i=e-parseInt(e/2)),t>4096&&(t=4096),o||u();var d,l;return d=0,l=c.length,c.forEach(function(t){var e=new Image,a=t;n[a]||(e.id=a,e.src=t,e.onload=function(){s(this);l==++d&&(r.forEach(function(t){t.textureInfo?t.textureInfo.updateTexture(t.atlas.canvas):t.textureInfo=RedTextureInfo(f,t.atlas.canvas,t.atlas.__targetIndex)}),h&&h())})}),RedAtlasTextureManager}).getByKey=function(t){return n[t]},Object.freeze(RedAtlasTextureManager)}();var RedAtlasTextureInfo;!function(){var t;t={},RedAtlasTextureInfo=function(){var e,r;return function(n,a){if(!(this instanceof RedAtlasTextureInfo))return new RedAtlasTextureInfo(n,a);if(!(n instanceof Array))throw"atlasUVInfo는 Array만 허용합니다.";if(!(a instanceof RedAtlasInfo))throw"parentAtlasInfo는 RedAtlasInfo  인스턴스만 허용합니다.";e=[n[0][0],1-n[2][1],n[1][0]-n[0][0],n[2][1]-n[0][1]],r=e.toString(),n=t[r]?t[r]:t[r]=RedAtlasUVInfo(e),this.atlasUVInfo=n,this.parentAtlasInfo=a,this.__webglAtlasTexture=1,Object.freeze(this)}}()}();var RedBaseRenderInfo;!function(){var t,e;t=Math.sin,e=Math.cos,(RedBaseRenderInfo=function(r,n,a){if(!(this instanceof RedBaseRenderInfo))return new RedBaseRenderInfo(r,n,a);if(!(r instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";var i;i=this,this.callback=a,this.targetScene=n,this.__UUID=REDGL_UUID++;var o,u,s,f,c,h,d,l,_,M,R,m,I,v,E,x,g,A,T,b,p,w,y,U,L,P,S,D,N,F,B,G,O,C,Y,V,j,z,X,q,k,H,Z,W,Q,K,J,$,tt,et,rt,nt,at,it,ot,ut,st,ft,ct,ht,dt,lt,_t,Mt,Rt,mt,It,vt,Et,xt,gt,At,Tt,bt,pt,wt,yt,Ut,Lt,Pt,St,Dt,Nt,Ft={float:"uniform1f",int:"uniform1i"},Bt=[];for(Et={},gt={},At={},Tt={},bt={},yt={},o=50;o--;)bt[o]=null;wt={int:null,float:null},this.render=function(t){xt=void 0,i.callback&&i.callback(t),i.numDrawCall=0,$=r.gl,u=i.targetScene,$.clear($.COLOR_BUFFER_BIT),u.camera.update();for(o in r.__datas.RedProgramInfo){var e;e=r.__datas.RedProgramInfo[o],$.useProgram(e.program),Mt=e.uniforms.uPMatrix.location,$.uniformMatrix4fv(Mt,!1,u.camera.uPMatrix),Mt=e.uniforms.uCameraMatrix.location,$.uniformMatrix4fv(Mt,!1,u.camera.uCameraMatrix),i.setAmbientLight(e),i.setDirectionalLight(e),i.setPointLight(e),e.uniforms.uSystemTime&&(Mt=e.uniforms.uSystemTime.location,$.uniform1f(Mt,t/1e3)),e.uniforms.uSystemResolution&&(Mt=e.uniforms.uSystemResolution.location,$.uniform2fv(Mt,new Float32Array([$.drawingBufferWidth,$.drawingBufferHeight])))}It=null,i.drawSkyBox(u.skyBox,t),$.clear($.DEPTH_BUFFER_BIT),i.draw(u.children,t),i.draw(Bt),i.drawGrid(u.grid,t),requestAnimationFrame(i.render)},this.setAmbientLight=function(){var t=new Float32Array(4);return function(e){u.lights[RedAmbientLightInfo.TYPE].length&&e.uniforms.uAmbientLightColor&&(u.lights[RedAmbientLightInfo.TYPE].forEach(function(e,r){t[4*r+0]=e.color[0],t[4*r+1]=e.color[1],t[4*r+2]=e.color[2],t[4*r+3]=e.color[3]}),Mt=e.uniforms.uAmbientLightColor.location,$.uniform4fv(Mt,t))}}(),this.setDirectionalLight=function(){var t=[],e=[];return function(r){u.lights[RedDirectionalLightInfo.TYPE].length&&r.uniforms.uDirectionnalLightDirection&&(t.length=0,e.length=0,u.lights[RedDirectionalLightInfo.TYPE].forEach(function(r,n){t[3*n+0]=r.direction[0],t[3*n+1]=r.direction[1],t[3*n+2]=r.direction[2],e[4*n+0]=r.color[0],e[4*n+1]=r.color[1],e[4*n+2]=r.color[2],e[4*n+3]=r.color[3]}),Mt=r.uniforms.uDirectionnalLightDirection.location,$.uniform3fv(Mt,new Float32Array(t)),Mt=r.uniforms.uDirectionnalLightColor.location,$.uniform4fv(Mt,new Float32Array(e)),Mt=r.uniforms.uDirectionalNum.location,$.uniform1i(Mt,u.lights[RedDirectionalLightInfo.TYPE].length))}}(),this.setPointLight=function(){var t=[],e=[],r=new Float32Array(16);return function(n){u.lights.point.length&&n.uniforms.uPointNum&&(t.length=0,e.length=0,Bt.length=0,u.lights[RedPointLightInfo.TYPE].forEach(function(n,a){t[3*a+0]=n.position[0],t[3*a+1]=n.position[1],t[3*a+2]=n.position[2],e[4*a+0]=n.color[0],e[4*a+1]=n.color[1],e[4*a+2]=n.color[2],e[4*a+3]=n.color[3],r[a]=n.radius,n.useDebugMode&&(Bt.push(n.__debugMesh),n.__debugMesh.position[0]=n.position[0],n.__debugMesh.position[1]=n.position[1],n.__debugMesh.position[2]=n.position[2],n.__debugMesh.scale[0]=2*n.radius,n.__debugMesh.scale[1]=2*n.radius,n.__debugMesh.scale[2]=2*n.radius,n.__debugMesh.materialInfo.uColor[0]=n.color[0],n.__debugMesh.materialInfo.uColor[1]=n.color[1],n.__debugMesh.materialInfo.uColor[2]=n.color[2],n.__debugMesh.materialInfo.uColor[3]=.5)}),Mt=n.uniforms.uPointLightPosition.location,$.uniform3fv(Mt,new Float32Array(t)),Mt=n.uniforms.uPointLightColor.location,$.uniform4fv(Mt,new Float32Array(e)),Mt=n.uniforms.uPointNum.location,$.uniform1i(Mt,u.lights[RedPointLightInfo.TYPE].length),Mt=n.uniforms.uPointLightRadius.location,$.uniform1fv(Mt,r))}}(),this.drawGrid=function(){var t=[];return function(e){e&&(t.length=0,t.push(e),i.draw(t))}}(),this.drawSkyBox=function(){var t=[];return function(e){e&&(e.scale[0]=e.scale[1]=e.scale[2]=u.camera.far,t.length=0,t.push(e),i.draw(t))}}(),this.draw=function(r,n,a){var o,u;for(o=r.length;o--;){if(i.numDrawCall++,s=r[o],f=s.uMVMatrix,c=s.uNMatrix,f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,h=f,Q=s.position[0],K=s.position[1],J=s.position[2],h[12]=h[0]*Q+h[4]*K+h[8]*J+h[12],h[13]=h[1]*Q+h[5]*K+h[9]*J+h[13],h[14]=h[2]*Q+h[6]*K+h[10]*J+h[14],h[15]=h[3]*Q+h[7]*K+h[11]*J+h[15],I=s.rotation[0],v=s.rotation[1],E=s.rotation[2],d=t(I),M=e(I),l=t(v),R=e(v),_=t(E),m=e(E),x=h[0],g=h[1],A=h[2],b=h[4],p=h[5],w=h[6],U=h[8],L=h[9],P=h[10],V=R*m,j=d*l*m-M*_,z=M*l*m+d*_,X=R*_,q=d*l*_+M*m,k=M*l*_-d*m,H=-l,Z=d*R,W=M*R,h[0]=x*V+b*j+U*z,h[1]=g*V+p*j+L*z,h[2]=A*V+w*j+P*z,h[4]=x*X+b*q+U*k,h[5]=g*X+p*q+L*k,h[6]=A*X+w*q+P*k,h[8]=x*H+b*Z+U*W,h[9]=g*H+p*Z+L*W,h[10]=A*H+w*Z+P*W,Q=s.scale[0],K=s.scale[1],J=s.scale[2],h[0]=h[0]*Q,h[1]=h[1]*Q,h[2]=h[2]*Q,h[3]=h[3]*Q,h[4]=h[4]*K,h[5]=h[5]*K,h[6]=h[6]*K,h[7]=h[7]*K,h[8]=h[8]*J,h[9]=h[9]*J,h[10]=h[10]*J,h[11]=h[11]*J,h[12]=h[12],h[13]=h[13],h[14]=h[14],h[15]=h[15],a){var Bt=new glMatrix.ARRAY_TYPE(16);Bt[0]=a[0],Bt[1]=a[1],Bt[2]=a[2],Bt[3]=a[3],Bt[4]=a[4],Bt[5]=a[5],Bt[6]=a[6],Bt[7]=a[7],Bt[8]=a[8],Bt[9]=a[9],Bt[10]=a[10],Bt[11]=a[11],Bt[12]=a[12],Bt[13]=a[13],Bt[14]=a[14],Bt[15]=a[15],x=Bt[0],g=Bt[1],A=Bt[2],T=Bt[3],b=Bt[4],p=Bt[5],w=Bt[6],y=Bt[7],U=Bt[8],L=Bt[9],P=Bt[10],S=Bt[11],D=Bt[12],N=Bt[13],F=Bt[14],B=Bt[15],G=f[0],O=f[1],C=f[2],Y=f[3],f[0]=G*x+O*b+C*U+Y*D,f[1]=G*g+O*p+C*L+Y*N,f[2]=G*A+O*w+C*P+Y*F,f[3]=G*T+O*y+C*S+Y*B,G=f[4],O=f[5],C=f[6],Y=f[7],f[4]=G*x+O*b+C*U+Y*D,f[5]=G*g+O*p+C*L+Y*N,f[6]=G*A+O*w+C*P+Y*F,f[7]=G*T+O*y+C*S+Y*B,G=f[8],O=f[9],C=f[10],Y=f[11],f[8]=G*x+O*b+C*U+Y*D,f[9]=G*g+O*p+C*L+Y*N,f[10]=G*A+O*w+C*P+Y*F,f[11]=G*T+O*y+C*S+Y*B,G=f[12],O=f[13],C=f[14],Y=f[15],f[12]=G*x+O*b+C*U+Y*D,f[13]=G*g+O*p+C*L+Y*N,f[14]=G*A+O*w+C*P+Y*F,f[15]=G*T+O*y+C*S+Y*B}for(tt=s.materialInfo,et=tt.programInfo,rt=et.program,nt=s.geometryInfo,at=nt.attributes,it=nt.__attributeList,ot=et.attributes,ft=tt.uniforms,ht=et.uniforms,Rt=nt.indices,mt=at.vertexPosition,It!=rt&&($.useProgram(rt),gt={},Tt={},At={},bt={},pt=void 0,yt={},wt={int:null,float:null}),vt=et,It=rt,u=it.length;u--;)ut=it[u],st=ut.shaderPointerKey,ot[st]&&(Mt=ot[st].location,Et[Mt]==ut.__UUID||($.bindBuffer($.ARRAY_BUFFER,ut.buffer),ut.enabled||($.enableVertexAttribArray(Mt),ut.enabled=1),$.vertexAttribPointer(Mt,ut.pointSize,ut.arrayType,ut.normalize,ut.stride,ut.offset),Et[Mt]=ut.__UUID));tt.needUniformList&&tt.updateUniformList(),u=(ct=tt.__uniformList).length;for(var Gt=!0;u--;)if(dt=ct[u].key,_t=ct[u].type,lt=tt[dt],Mt=ct[u].location,void 0==lt);else if("uAtlascoord"==dt)pt==lt.__UUID||$.uniform4fv(Mt,lt.value),pt=lt.__UUID;else if(lt.__uniformMethod)lt.__isMatrix?$[lt.__uniformMethod](Mt,!1,lt):$[lt.__uniformMethod](Mt,lt);else if(Ft[_t])wt[_t]==lt||$[Ft[_t]](Mt,lt),wt[_t]=lt;else if(lt.__webglAtlasTexture){var Ot;(Ot=lt.parentAtlasInfo.textureInfo).loaded?(Tt[Ot.__targetIndex]!=Ot.__UUID&&($.activeTexture($.TEXTURE0+Ot.__targetIndex),$.bindTexture($.TEXTURE_2D,Ot.texture),Tt[Ot.__targetIndex]=Ot.__UUID),bt[Ot.__targetIndex]!=Ot.__UUID&&$.uniform1i(Mt,Ot.__targetIndex),bt[Ot.__targetIndex]=Ot.__UUID):void 0==Tt[Ot.__targetIndex]&&(Gt=!1)}else if(lt.__webglTexture)lt.loaded?(gt[lt.__targetIndex]!=lt.__UUID&&($.activeTexture($.TEXTURE0+lt.__targetIndex),$.bindTexture($.TEXTURE_2D,lt.texture),gt[lt.__targetIndex]=lt.__UUID),bt[lt.__targetIndex]!=lt.__UUID&&$.uniform1i(Mt,lt.__targetIndex),bt[lt.__targetIndex]=lt.__UUID):void 0==gt[lt.__targetIndex]&&(Gt=!1);else{if(!lt.__webglCubeTexture)throw"안되는 나쁜 타입인거야!!";lt.loaded?(At[lt.__targetIndex]!=lt.__UUID&&($.activeTexture($.TEXTURE0+lt.__targetIndex),$.bindTexture($.TEXTURE_CUBE_MAP,lt.texture),At[lt.__targetIndex]=lt.__UUID),bt[lt.__targetIndex]!=lt.__UUID&&$.uniform1i(Mt,lt.__targetIndex),bt[lt.__targetIndex]=lt.__UUID):void 0==At[lt.__targetIndex]&&(Gt=!1)}if(et.uniforms.uUseNormalTexture)if(tt.uNormalTexture&&tt.uNormalTexture.loaded){if(tt.uNormalTexture.__targetIndex!=RedTextureIndex.NORMAL)throw"노말 인덱스타입이 아닙니다.";1==yt.cacheUseNormalTexture||$.uniform1i(et.uniforms.uUseNormalTexture.location,1),yt.cacheUseNormalTexture=1}else 0==yt.cacheUseNormalTexture||$.uniform1i(et.uniforms.uUseNormalTexture.location,0),yt.cacheUseNormalTexture=0;if(et.uniforms.uUseDisplacementTexture)if(tt.uDisplacementTexture&&tt.uDisplacementTexture.loaded){if(tt.uDisplacementTexture.__targetIndex!=RedTextureIndex.DISPLACEMENT)throw"DISPLACEMENT 인덱스타입이 아닙니다.";1==yt.cacheUseDisplacementTexture||$.uniform1i(et.uniforms.uUseDisplacementTexture.location,1),yt.cacheUseDisplacementTexture=1}else 0==yt.cacheUseDisplacementTexture||$.uniform1i(et.uniforms.uUseDisplacementTexture.location,0),yt.cacheUseDisplacementTexture=0;if(et.uniforms.uUseSpecularTexture)if(tt.uSpecularTexture&&tt.uSpecularTexture.loaded){if(tt.uSpecularTexture.__targetIndex!=RedTextureIndex.SPECULAR)throw"SPECULAR 인덱스타입이 아닙니다.";1==yt.cacheUseSpecularTexture||$.uniform1i(et.uniforms.uUseSpecularTexture.location,1),yt.cacheUseSpecularTexture=1}else 0==yt.cacheUseSpecularTexture||$.uniform1i(et.uniforms.uUseSpecularTexture.location,0),yt.cacheUseSpecularTexture=0;if(et.uniforms.uUseEtcVertexTexture1)if(tt.uEtcVertextTexture1&&tt.uEtcVertextTexture1.loaded){if(tt.uEtcVertextTexture1.__targetIndex!=RedTextureIndex.ETC_VERTEXT_1)throw"ETC_VERTEXT_1 인덱스타입이 아닙니다.";1==yt.cacheUseEtcVertexTexture1||$.uniform1i(et.uniforms.uUseEtcVertexTexture1.location,1),yt.cacheUseEtcVertexTexture1=1}else 0==yt.cacheUseEtcVertexTexture1||$.uniform1i(et.uniforms.uUseEtcVertexTexture1.location,0),yt.cacheUseEtcVertexTexture1=0;if(et.uniforms.uUseEtcVertexTexture2)if(tt.uEtcVertextTexture2&&tt.uEtcVertextTexture2.loaded){if(tt.uEtcVertextTexture2.__targetIndex!=RedTextureIndex.ETC_VERTEXT_2)throw"ETC_VERTEXT_2 인덱스타입이 아닙니다.";1==yt.cacheUseEtcVertexTexture2||$.uniform1i(et.uniforms.uUseEtcVertexTexture2.location,1),yt.cacheUseEtcVertexTexture2=1}else 0==yt.cacheUseEtcVertexTexture2||$.uniform1i(et.uniforms.uUseEtcVertexTexture2.location,0),yt.cacheUseEtcVertexTexture2=0;if(et.uniforms.uUseEtcFragmentTexture1)if(tt.uEtcFragmentTexture1&&tt.uEtcFragmentTexture1.loaded){if(tt.uEtcFragmentTexture1.__targetIndex!=RedTextureIndex.ETC_FRAGMENT_1)throw"ETC_FRAGMENT_1 인덱스타입이 아닙니다.";1==yt.cacheUseEtcFragmentTexture1||$.uniform1i(et.uniforms.uUseEtcFragmentTexture1.location,1),yt.cacheUseEtcFragmentTexture1=1}else 0==yt.cacheUseEtcFragmentTexture1||$.uniform1i(et.uniforms.uUseEtcFragmentTexture1.location,0),yt.cacheUseEtcFragmentTexture1=0;if(et.uniforms.uUseEtcFragmentTexture2)if(tt.uEtcFragmentTexture2&&tt.uEtcFragmentTexture2.loaded){if(tt.uEtcFragmentTexture2.__targetIndex!=RedTextureIndex.ETC_FRAGMENT_2)throw"ETC_FRAGMENT_2 인덱스타입이 아닙니다.";1==yt.cacheUseEtcFragmentTexture2||$.uniform1i(et.uniforms.uUseEtcFragmentTexture2.location,1),yt.cacheUseEtcFragmentTexture2=1}else 0==yt.cacheUseEtcFragmentTexture2||$.uniform1i(et.uniforms.uUseEtcFragmentTexture2.location,0),yt.cacheUseEtcFragmentTexture2=0;if(ht.uNMatrix){c[0]=f[0],c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=f[6],c[7]=f[7],c[8]=f[8],c[9]=f[9],c[10]=f[10],c[11]=f[11],c[12]=f[12],c[13]=f[13],c[14]=f[14],c[15]=f[15];var Ct=c[0],Yt=c[1],Vt=c[2],jt=c[3],zt=c[4],Xt=c[5],qt=c[6],kt=c[7],Ht=c[8],Zt=c[9],Wt=c[10],Qt=c[11],Kt=c[12],Jt=c[13],$t=c[14],te=c[15],ee=Ct*Xt-Yt*zt,re=Ct*qt-Vt*zt,ne=Ct*kt-jt*zt,ae=Yt*qt-Vt*Xt,ie=Yt*kt-jt*Xt,oe=Vt*kt-jt*qt,ue=Ht*Jt-Zt*Kt,se=Ht*$t-Wt*Kt,fe=Ht*te-Qt*Kt,ce=Zt*$t-Wt*Jt,he=Zt*te-Qt*Jt,de=Wt*te-Qt*$t,le=ee*de-re*he+ne*ce+ae*fe-ie*se+oe*ue;le=1/le,c[0]=(Xt*de-qt*he+kt*ce)*le,c[1]=(-Yt*de+Vt*he-jt*ce)*le,c[2]=(Jt*oe-$t*ie+te*ae)*le,c[3]=(-Zt*oe+Wt*ie-Qt*ae)*le,c[4]=(-zt*de+qt*fe-kt*se)*le,c[5]=(Ct*de-Vt*fe+jt*se)*le,c[6]=(-Kt*oe+$t*ne-te*re)*le,c[7]=(Ht*oe-Wt*ne+Qt*re)*le,c[8]=(zt*he-Xt*fe+kt*ue)*le,c[9]=(-Ct*he+Yt*fe-jt*ue)*le,c[10]=(Kt*ie-Jt*ne+te*ee)*le,c[11]=(-Ht*ie+Zt*ne-Qt*ee)*le,c[12]=(-zt*ce+Xt*se-qt*ue)*le,c[13]=(Ct*ce-Yt*se+Vt*ue)*le,c[14]=(-Kt*ae+Jt*re-$t*ee)*le,c[15]=(Ht*ae-Zt*re+Wt*ee)*le,g=c[1],A=c[2],T=c[3],w=c[6],y=c[7],S=c[11],c[1]=c[4],c[2]=c[8],c[3]=c[12],c[4]=g,c[6]=c[9],c[7]=c[13],c[8]=A,c[9]=w,c[11]=c[14],c[12]=T,c[13]=y,c[14]=S,$.uniformMatrix4fv(ht.uNMatrix.location,!1,c)}$.uniformMatrix4fv(ht.uMVMatrix.location,!1,f),Ut!=s.useCullFace&&((Ut=s.useCullFace)?$.enable($.CULL_FACE):$.disable($.CULL_FACE)),Lt!=s.cullFace&&($.cullFace(s.cullFace),Lt=s.cullFace),Dt!=s.useDepthTest&&((Dt=s.useDepthTest)?$.enable($.DEPTH_TEST):$.disable($.DEPTH_TEST)),Nt!=s.depthTestFunc&&$.depthFunc(Nt=s.depthTestFunc),Pt!=s.useBlendMode&&((Pt=s.useBlendMode)?$.enable($.BLEND):$.disable($.BLEND)),St!=s.blendFactor1+s.blendFactor2&&($.blendFunc(s.blendFactor1,s.blendFactor2),St=s.blendFactor1+s.blendFactor2),Rt?Gt&&(xt==Rt.__UUID||$.bindBuffer($.ELEMENT_ARRAY_BUFFER,Rt.buffer),$.drawElements(s.drawMode,Rt.pointNum,$.UNSIGNED_SHORT,0),xt=Rt.__UUID):($.drawArrays(s.drawMode,0,mt.pointNum),xt=mt.__UUID),s.children.length&&i.draw(s.children,n,f)}}}).prototype={start:function(){return requestAnimationFrame(this.render),this},pause:function(){return this},resume:function(){return this},numDrawCall:0},Object.freeze(RedBaseRenderInfo)}();var redGLDetect;!function(){var t,e,r,n,a,i;redGLDetect=function(o){if(!(this instanceof redGLDetect))return new redGLDetect(o);if(!(o instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";for(i=o.gl,t="VENDOR,VERSION,SHADING_LANGUAGE_VERSION,RENDERER,MAX_VERTEX_ATTRIBS,MAX_VARYING_VECTORS,MAX_VERTEX_UNIFORM_VECTORS,MAX_VERTEX_TEXTURE_IMAGE_UNITS,MAX_FRAGMENT_UNIFORM_VECTORS,MAX_TEXTURE_SIZE,MAX_CUBE_MAP_TEXTURE_SIZE,MAX_COMBINED_TEXTURE_IMAGE_UNITS,MAX_TEXTURE_IMAGE_UNITS,MAX_RENDERBUFFER_SIZE,MAX_VIEWPORT_DIMS,RED_BITS,GREEN_BITS,BLUE_BITS,ALPHA_BITS,DEPTH_BITS,STENCIL_BITS".split(","),e=/[_]\S/g,r=function(t){return t.charAt(1).toUpperCase()},n=t.length;n--;)this[a=t[n]]=i.getParameter(i[a])}}();var RedSkyBoxInfo;RedSkyBoxInfo=function(t,e){if(!(this instanceof RedSkyBoxInfo))return new RedSkyBoxInfo(t,e);if(!(t instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(!(e instanceof Array))throw"srcList는 Array만 허용됩니다.";if(6!=e.length)throw"srcList는 6개여야 합니다.";RedMeshBaseInfo.call(this,t),this.materialInfo=RedMaterialInfo(t,"skybox",RedCubeTextureInfo(t,e)),this.geometryInfo=RedPrimitive.cube(t),this.scale[0]=1e3,this.scale[1]=1e3,this.scale[2]=1e3,this.cullFace=t.gl.FRONT},Object.freeze(RedSkyBoxInfo);var RedShaderLoader;RedShaderLoader=function(t,e){if(!(this instanceof RedShaderLoader))return new RedShaderLoader(t,e);var r=0;t.callback=e,t.forEach(function(e,n){var a=new XMLHttpRequest;a.open("GET",e.src,!0),a.onreadystatechange=function(){var n;4==a.readyState&&200==a.status&&((n=document.createElement("script")).setAttribute("id",e.id),n.setAttribute("type","glsl"),n.text=a.responseText,document.body.appendChild(n),++r==t.length&&t.callback&&t.callback())},a.send(null)})};var RedGL,REDGL_UUID;!function(){var t,e=[];REDGL_UUID=0,t=function(){var t,e,r,n;return e={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},t="experimental-webgl,webgl,webkit-3d,moz-webgl,3d".split(","),function(a){for(n=t.length;n--;)if(r=a.getContext(t[n],e))return r;throw"웹지엘을 사용할수없습니다."}}(),RedGL=function(r,n,a,i){if(!(this instanceof RedGL))return new RedGL(r,n,a,i);var o;this.__canvas=r,this.gl=o=t(r),a&&this.setSize(),this.fullMode=a,this.__UUID=REDGL_UUID++,this.__datas={},this.detect=redGLDetect(this),o.enable(o.DEPTH_TEST),o.depthFunc(o.LESS),o.frontFace(o.CCW),o.enable(o.CULL_FACE),o.cullFace(o.BACK),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),o.enable(o.SCISSOR_TEST),o.scissor(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),e.push(this),i?RedShaderLoader(i,n):n&&n(),this.createTextureInfo("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC")},window.addEventListener("resize",function(){e.forEach(function(t){t.fullMode&&t.setSize()})}),RedGL.prototype={setSize:function(t,e){var r,n,a;n=t||(document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),a=e||(document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),r=this.gl,n=n,a=a,this.__canvas.width=n*window.devicePixelRatio,this.__canvas.height=a*window.devicePixelRatio,this.__canvas.style.width=n,this.__canvas.style.height=a,r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.enable(r.SCISSOR_TEST),r.scissor(0,0,r.drawingBufferWidth,r.drawingBufferHeight)},calcNormal:function(){var t,e,r;return t=Math.sqrt,e={x:0,y:0,z:0},r={x:0,y:0,z:0},function(n,a){var i,o,u,s,f=new Float32Array(n.length);for(i=0,o=n.length;i<o;i++)f[i]=0;for(i=0,o=a.length;i<o;i+=3)for(u=3*a[i+1],s=3*a[i],e.x=n[u]-n[s],e.y=n[u+1]-n[s+1],e.z=n[u+2]-n[s+2],s=3*a[i+2],r.x=n[s]-n[u],r.y=n[s+1]-n[u+1],r.z=n[s+2]-n[u+2],u=0;u<3;u++)f[s=3*a[i+u]]+=e.y*r.z-e.z*r.y,f[s+1]+=e.z*r.x-e.x*r.z,f[s+2]+=e.x*r.y-e.y*r.x;for(i=0,o=n.length;i<o;i+=3)e.x=f[i],e.y=f[i+1],e.z=f[i+2],u=t(e.x*e.x+e.y*e.y+e.z*e.z)||1e-5,f[i]=e.x/u,f[i+1]=e.y/u,f[i+2]=e.z/u;return f}}(),getSourceFromScript:function(){var t,e,r;return function(n){if(!(t=document.getElementById(n)))throw"쉐이더소스가 없음!";for(e="",r=t.firstChild;r;)3==r.nodeType&&(e+=r.textContent),r=r.nextSibling;return e}}(),createShaderInfo:function(t,e,r){return new RedShaderInfo(this,t,e,r)},getShaderInfo:function(t,e){return this.__datas.shaderInfo[e][t]},createProgramInfo:function(t,e,r,n){return new RedProgramInfo(this,t,e,r,n)},getProgramInfo:function(t){return this.__datas.RedProgramInfo[t]},createArrayBufferInfo:function(t,e,r,n,a,i,o,u,s,f){return new RedBufferInfo(this,RedBufferInfo.ARRAY_BUFFER,t,e,r,n,a,i,o,u,s,f)},createIndexBufferInfo:function(t,e,r,n,a,i,o,u,s){return new RedBufferInfo(this,RedBufferInfo.ELEMENT_ARRAY_BUFFER,t,null,e,r,n,a,i,o,u,s)},getArrayBufferInfo:function(t){return this.__datas.RedBufferInfo[t]},getIndexBufferInfo:function(t){return this.__datas.RedBufferInfo[t]},createGeometryInfo:function(t,e,r,n,a){return new RedGeometryInfo(this,t,e,r,n,a)},getGeometryInfo:function(t){return this.__datas.RedGeometryInfo[t]},createMaterialDefine:function(t){return new RedMaterialDefine(this,t)},createMaterialInfo:function(t,e,r,n,a){return new RedMaterialInfo(this,t,e,r,n,a)},createTextureInfo:function(t,e,r,n,a,i){return new RedTextureInfo(this,t,e,r,n,a,i)},createMeshInfo:function(t,e,r){return new RedMeshInfo(this,t,e,r)},getMeshInfo:function(t){return this.__datas.RedMeshInfo[t]},createSceneInfo:function(t,e){return new RedSceneInfo(this,t,e)},createAmbientLight:function(){return new RedAmbientLightInfo(this)},createDirectionalLight:function(){return new RedDirectionalLightInfo(this)},createPointLight:function(){return new RedPointLightInfo(this)},createSkyBoxInfo:function(t){return new RedSkyBoxInfo(this,t)},createBaseCameraInfo:function(t){return new RedBaseCameraInfo(this,t)},getBaseCameraInfo:function(t){return this.__datas.RedBaseCameraInfo[t]},createBaseRenderInfo:function(t,e){return new RedBaseRenderInfo(this,t,e)}}}();var Atlas;!function(){var t;(t=function(t,e,r,n){this.x=t,this.y=e,this.w=r,this.h=n}).prototype.fitsIn=function(t){return t.w>=this.w&&t.h>=this.h},t.prototype.sameSizeAs=function(t){return this.w===t.w&&this.h===t.h},(Atlas=function(e,r,n,a){1===arguments.length&&(this.canvas=e,e=r=0,n=this.canvas.width,a=this.canvas.height),2===arguments.length&&(n=e,a=r,e=r=0),this.left=this.right=null,this.rect=new t(e,r,n,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new Atlas(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new Atlas(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new Atlas(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new Atlas(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},Atlas.prototype.expand=function(t){var e=this;t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t));var r;if(this.rect.w<this.rect.h?((r=new Atlas(0,0,this.rect.w+t.w,this.rect.h)).right=new Atlas(this.rect.w,0,t.w,this.rect.h),r.left=this):((r=new Atlas(0,0,this.rect.w,this.rect.h+t.h)).right=new Atlas(0,this.rect.h,this.rect.w,t.h),r.left=this),["canvas","context","img"].forEach(function(t){e[t]&&(r[t]=e[t],e[t]=null)}),r.canvas){r.context||(r.context=r.canvas.getContext("2d"));var n=r.context.getImageData(0,0,r.canvas.width,r.canvas.height);r.canvas.width=r.rect.w,r.canvas.height=r.rect.h,r.context.putImageData(n,0,0)}return!1===r.pack(t)?r.expand(t):r},Atlas.prototype.index=function(){var t=this;return t._cache.length>0?t._cache:(function e(r){null!==r.left?(e(r.left),e(r.right)):r.rect.name&&t._cache.push(r.rect)}(t),t._cache)},Atlas.prototype.uv=function(t,e){var r=this;t=t||r.rect.w,e=e||r.rect.h;var n=this.tilepad;return function a(i){if(null!==i.left)a(i.left),a(i.right);else if(void 0!==i.rect.name){var o=n?i.rect.w/4:0;r._uvcache[i.rect.name]=[[i.rect.x+o,i.rect.y+o],[i.rect.x+o+(i.rect.w-2*o),i.rect.y+o],[i.rect.x+o+(i.rect.w-2*o),i.rect.y+o+(i.rect.h-2*o)],[i.rect.x+o,i.rect.y+o+(i.rect.h-2*o)]].map(function(r){return 0!==r[0]&&(r[0]=r[0]/t),0!==r[1]&&(r[1]=r[1]/e),r})}}(r),r._uvcache},Atlas.prototype.json=function(t){var e=this;return t?("string"==typeof t&&(t=JSON.parse(t)),function t(e){if(e&&e.rect){var r=new Atlas(e.rect.x,e.rect.y,e.rect.w,e.rect.h);return e.left&&(r.left=t(e.left)),e.right&&(r.right=t(e.right)),r}}(t)):JSON.stringify(function t(e){var r={left:null,right:null,rect:e.rect,filled:e.filled};return null!==e.left&&(r.left=t(e.left),r.right=t(e.right)),r}(e),null,2)},Atlas.prototype._tilepad=function(e){var r=this.img;if(!r)return e;var n=r.width/2,a=document.createElement("canvas");a.name=r.name||r.src,a.id=r.id||"",a.width=r.width+r.width,a.height=r.height+r.height;var i=a.getContext("2d"),o=i.createPattern(r,"repeat");return i.fillStyle=o,i.translate(n,n),i.fillRect(-n,-n,a.width+n,a.height+n),i.translate(-n,-n),this.img=a,new t(e.x,e.y,this.img.width,this.img.height)},Atlas.prototype._ontoCanvas=function(t){return t&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.canvas.ctx=this.context,this.context.clearRect(t.rect.x,t.rect.y,t.rect.w,t.rect.h),this.context.drawImage(this.img,t.rect.x,t.rect.y,t.rect.w,t.rect.h),t.rect.name=this.img.id||this.img.name||this.img.src||null),t},Atlas.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new t(e.x,e.y,e.width,e.height)),e instanceof t||(e=new t(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},Atlas.prototype._debug=function(){if(this.canvas){var t=this.canvas.getContext("2d");this.index().forEach(function(e){t.lineWidth=1,t.strokeStyle="red",t.strokeRect(e.x,e.y,e.w,e.h)})}}}();console.log('LOGIN Release. last update(2017-12-22 17:46:01)');